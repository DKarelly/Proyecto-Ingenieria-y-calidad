<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Consultar Incidencia - Clínica Union</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;900&family=Noto+Sans:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            font-family: 'Inter', sans-serif;
        }
        .badge-abierta {
            background: #fbbf24;
            color: #92400e;
        }
        .badge-en-progreso {
            background: #3b82f6;
            color: white;
        }
        .badge-en-proceso {
            background: #3b82f6;
            color: white;
        }
        .badge-resuelta {
            background: #10b981;
            color: white;
        }
        .badge-cerrada {
            background: #d1d5db;
            color: #374151;
        }

        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
        }
        .modal.show {
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .modal-content {
            background: white;
            border-radius: 1rem;
            padding: 2rem;
            max-width: 900px;
            width: 90%;
            max-height: 90vh;
            overflow-y: auto;
            animation: modalSlideIn 0.3s ease-out;
        }

        @keyframes modalSlideIn {
            from {
                opacity: 0;
                transform: translateY(-50px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* Estilos mejorados para botones de acción */
        .action-btn {
            position: relative;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: 36px;
            height: 36px;
            border-radius: 8px;
            transition: all 0.2s ease;
            cursor: pointer;
            border: none;
        }

        .action-btn i {
            font-size: 16px;
        }

        .action-btn-view {
            background: linear-gradient(135deg, #06b6d4 0%, #0891b2 100%);
            color: white;
            box-shadow: 0 2px 8px rgba(6, 182, 212, 0.3);
        }

        .action-btn-view:hover {
            background: linear-gradient(135deg, #0891b2 0%, #0e7490 100%);
            box-shadow: 0 4px 12px rgba(6, 182, 212, 0.4);
            transform: translateY(-2px);
        }

        .action-btn-edit {
            background: linear-gradient(135deg, #3b82f6 0%, #2563eb 100%);
            color: white;
            box-shadow: 0 2px 8px rgba(59, 130, 246, 0.3);
        }

        .action-btn-edit:hover {
            background: linear-gradient(135deg, #2563eb 0%, #1d4ed8 100%);
            box-shadow: 0 4px 12px rgba(59, 130, 246, 0.4);
            transform: translateY(-2px);
        }

        .action-btn-resolve {
            background: linear-gradient(135deg, #10b981 0%, #059669 100%);
            color: white;
            box-shadow: 0 2px 8px rgba(16, 185, 129, 0.3);
        }

        .action-btn-resolve:hover {
            background: linear-gradient(135deg, #059669 0%, #047857 100%);
            box-shadow: 0 4px 12px rgba(16, 185, 129, 0.4);
            transform: translateY(-2px);
        }

        /* Tooltip */
        .tooltip {
            position: absolute;
            bottom: 100%;
            left: 50%;
            transform: translateX(-50%) translateY(-8px);
            background: #1f2937;
            color: white;
            padding: 6px 12px;
            border-radius: 6px;
            font-size: 12px;
            font-weight: 500;
            white-space: nowrap;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.2s ease, transform 0.2s ease;
            z-index: 1000;
        }

        .tooltip::after {
            content: '';
            position: absolute;
            top: 100%;
            left: 50%;
            transform: translateX(-50%);
            border: 5px solid transparent;
            border-top-color: #1f2937;
        }

        .action-btn:hover .tooltip {
            opacity: 1;
            transform: translateX(-50%) translateY(-12px);
        }

        /* Notificaciones Toast */
        .toast {
            position: fixed;
            top: 20px;
            right: 20px;
            background: white;
            padding: 16px 24px;
            border-radius: 12px;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.15);
            display: flex;
            align-items: center;
            gap: 12px;
            z-index: 9999;
            animation: slideInRight 0.3s ease-out;
            max-width: 400px;
        }

        .toast.success {
            border-left: 4px solid #10b981;
        }

        .toast.error {
            border-left: 4px solid #ef4444;
        }

        .toast.warning {
            border-left: 4px solid #f59e0b;
        }

        @keyframes slideInRight {
            from {
                opacity: 0;
                transform: translateX(400px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }

        @keyframes slideOutRight {
            from {
                opacity: 1;
                transform: translateX(0);
            }
            to {
                opacity: 0;
                transform: translateX(400px);
            }
        }

        .toast.hiding {
            animation: slideOutRight 0.3s ease-out forwards;
        }

        /* Loader para botones */
        .btn-loader {
            display: inline-block;
            width: 16px;
            height: 16px;
            border: 2px solid rgba(255, 255, 255, 0.3);
            border-top-color: white;
            border-radius: 50%;
            animation: spin 0.6s linear infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }
    </style>
</head>
<body class="bg-[#f8fafc]">

    {% include 'header_admin.html' %}

    <div class="max-w-7xl mx-auto p-6 md:p-10">
        <!-- Botón de regreso -->
        <div class="mb-6">
            <a href="/seguridad/incidencias" class="inline-flex items-center text-gray-600 hover:text-cyan-600 transition-colors">
                <i class="fas fa-arrow-left mr-2"></i>
                <span class="font-medium">Volver al Panel de Incidencias</span>
            </a>
        </div>

        <!-- Título -->
        <div class="mb-8">
            <h1 class="text-3xl font-black text-gray-800">Consultar Incidencias</h1>
            <p class="text-gray-600 mt-2">Visualiza y gestiona las incidencias reportadas en el sistema</p>
        </div>

        <!-- Filtros de búsqueda -->
        <div class="bg-white rounded-2xl shadow-sm border border-gray-200 p-6 mb-6 admin-card">
            <div class="flex items-center gap-2 mb-6">
                <i class="fas fa-filter text-cyan-600 text-xl"></i>
                <h3 class="text-xl font-bold text-gray-800">Filtros de Búsqueda</h3>
            </div>

            <form id="formFiltros">
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 mb-4">
                    <!-- Paciente -->
                    <div class="relative">
                        <label for="filtroPaciente" class="block text-sm font-semibold text-gray-700 mb-2">
                            <i class="fas fa-user-injured text-cyan-600 mr-1"></i>
                            Paciente
                        </label>
                        <input
                            type="text"
                            id="filtroPaciente"
                            placeholder="Buscar paciente..."
                            oninput="this.value = this.value.replace(/[0-9]/g, '')"
                            class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-cyan-200 focus:border-cyan-500 transition-colors"
                        >
                        <div id="sugerenciasPaciente" class="absolute z-10 w-full bg-white border border-gray-300 rounded-lg shadow-lg mt-1 max-h-40 overflow-y-auto hidden">
                        </div>
                    </div>

                    <!-- Empleado -->
                    <div class="relative">
                        <label for="filtroEmpleado" class="block text-sm font-semibold text-gray-700 mb-2">
                            <i class="fas fa-user-tie text-cyan-600 mr-1"></i>
                            Empleado
                        </label>
                        <input
                            type="text"
                            id="filtroEmpleado"
                            placeholder="Buscar empleado..."
                            oninput="this.value = this.value.replace(/[0-9]/g, '')"
                            class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-cyan-200 focus:border-cyan-500 transition-colors"
                        >
                        <div id="sugerenciasEmpleado" class="absolute z-10 w-full bg-white border border-gray-300 rounded-lg shadow-lg mt-1 max-h-40 overflow-y-auto hidden">
                        </div>
                    </div>

                    <!-- Estado -->
                    <div>
                        <label for="filtroEstado" class="block text-sm font-semibold text-gray-700 mb-2">
                            <i class="fas fa-info-circle text-cyan-600 mr-1"></i>
                            Estado
                        </label>
                        <select id="filtroEstado" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-cyan-200 focus:border-cyan-500 transition-colors bg-white">
                            <option value="">Todos los estados</option>
                            <option>Abierta</option>
                            <option>En Progreso</option>
                            <option>Resuelta</option>
                            <option>Cerrada</option>
                        </select>
                    </div>
                </div>

                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4">
                    <!-- Fecha Registro -->
                    <div>
                        <label for="filtroFechaRegistro" class="block text-sm font-semibold text-gray-700 mb-2">
                            <i class="fas fa-calendar-alt text-cyan-600 mr-1"></i>
                            Fecha Registro
                        </label>
                        <input
                            type="date"
                            id="filtroFechaRegistro"
                            class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-cyan-200 focus:border-cyan-500 transition-colors"
                        >
                    </div>

                    <!-- Fecha Resolución -->
                    <div>
                        <label for="filtroFechaResolucion" class="block text-sm font-semibold text-gray-700 mb-2">
                            <i class="fas fa-calendar-check text-cyan-600 mr-1"></i>
                            Fecha Resolución
                        </label>
                        <input
                            type="date"
                            id="filtroFechaResolucion"
                            class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-cyan-200 focus:border-cyan-500 transition-colors"
                        >
                    </div>

                    <!-- Categoría -->
                    <div>
                        <label for="filtroCategoria" class="block text-sm font-semibold text-gray-700 mb-2">
                            <i class="fas fa-tags text-cyan-600 mr-1"></i>
                            Categoría
                        </label>
                        <select id="filtroCategoria" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-cyan-200 focus:border-cyan-500 transition-colors bg-white">
                            <option value="">Todas las categorías</option>
                            <option>Hardware</option>
                            <option>Software</option>
                            <option>Equipamiento Médico</option>
                            <option>Infraestructura</option>
                            <option>Insumos</option>
                            <option>Otro</option>
                        </select>
                    </div>

                    <!-- Prioridad -->
                    <div>
                        <label for="filtroPrioridad" class="block text-sm font-semibold text-gray-700 mb-2">
                            <i class="fas fa-exclamation-circle text-cyan-600 mr-1"></i>
                            Prioridad
                        </label>
                        <select id="filtroPrioridad" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-cyan-200 focus:border-cyan-500 transition-colors bg-white">
                            <option value="">Todas las prioridades</option>
                            <option>Alta</option>
                            <option>Media</option>
                            <option>Baja</option>
                        </select>
                    </div>
                </div>

                <!-- Botones -->
                <div class="flex items-center justify-end gap-3 mt-6 pt-4 border-t border-gray-200">
                    <button type="button" id="btnLimpiar" class="flex items-center gap-2 px-5 py-2.5 bg-gray-200 hover:bg-gray-300 text-gray-800 font-semibold rounded-lg transition-all">
                        <i class="fas fa-broom"></i>
                        Limpiar
                    </button>
                    <button type="submit" id="btnBuscar" class="flex items-center gap-2 px-6 py-2.5 bg-gradient-to-r from-cyan-500 to-blue-500 hover:from-cyan-600 hover:to-blue-600 text-white font-semibold rounded-lg transition-all shadow-md hover:shadow-lg">
                        <i class="fas fa-search"></i>
                        Buscar
                    </button>
                </div>
            </form>
        </div>

        <!-- Tabla de incidencias -->
        <div class="bg-white rounded-2xl shadow-sm border border-gray-200 overflow-hidden admin-card">
            <!-- Encabezado con contador -->
            <div class="px-6 py-4 border-b border-gray-200 bg-gradient-to-r from-gray-50 to-white">
                <div class="flex items-center justify-between">
                    <div class="flex items-center gap-3">
                        <div class="w-10 h-10 bg-gradient-to-br from-cyan-500 to-blue-500 rounded-lg flex items-center justify-center">
                            <i class="fas fa-list text-white"></i>
                        </div>
                        <div>
                            <h3 class="text-lg font-bold text-gray-800">Resultados de Búsqueda</h3>
                            <p class="text-sm text-gray-500" id="contadorResultados">Cargando incidencias...</p>
                        </div>
                    </div>
                    <div id="badgeFiltrosActivos" class="hidden">
                        <span class="px-3 py-1 bg-cyan-100 text-cyan-700 rounded-full text-sm font-semibold">
                            <i class="fas fa-filter mr-1"></i>
                            <span id="numFiltrosActivos">0</span> filtros activos
                        </span>
                    </div>
                </div>
            </div>

            <div class="overflow-x-auto">
                <table class="admin-table w-full">
                    <thead class="bg-gray-50 border-b border-gray-200">
                        <tr>
                            <th class="px-6 py-4 text-left text-xs font-bold text-gray-700 uppercase tracking-wider">ID</th>
                            <th class="px-6 py-4 text-left text-xs font-bold text-gray-700 uppercase tracking-wider">Descripción</th>
                            <th class="px-6 py-4 text-left text-xs font-bold text-gray-700 uppercase tracking-wider">Fecha</th>
                            <th class="px-6 py-4 text-left text-xs font-bold text-gray-700 uppercase tracking-wider">Paciente</th>
                            <th class="px-6 py-4 text-left text-xs font-bold text-gray-700 uppercase tracking-wider">Categoría</th>
                            <th class="px-6 py-4 text-left text-xs font-bold text-gray-700 uppercase tracking-wider">Prioridad</th>
                            <th class="px-6 py-4 text-left text-xs font-bold text-gray-700 uppercase tracking-wider">Trabajador</th>
                            <th class="px-6 py-4 text-center text-xs font-bold text-gray-700 uppercase tracking-wider">Estado</th>
                            <th class="px-6 py-4 text-center text-xs font-bold text-gray-700 uppercase tracking-wider">Acciones</th>
                        </tr>
                    </thead>
                    <tbody id="tablaIncidencias" class="divide-y divide-gray-200">
                        <!-- Datos dinámicos -->
                    </tbody>
                </table>
            </div>
        </div>

        <!-- Información adicional -->
        <div class="mt-6 grid grid-cols-1 md:grid-cols-2 gap-4">
            <div class="text-sm text-gray-600 bg-blue-50 rounded-lg p-4 border border-blue-200">
                <div class="flex items-start gap-3">
                    <i class="fas fa-info-circle text-blue-600 mt-1 text-lg"></i>
                    <div>
                        <p class="font-semibold text-blue-900 mb-1">Información sobre acciones</p>
                        <ul class="text-blue-700 space-y-1 text-xs">
                            <li>• <strong>Ver:</strong> Muestra los detalles completos de la incidencia</li>
                            <li>• <strong>Editar:</strong> Permite modificar los datos de la incidencia</li>
                            <li>• <strong>Resolver:</strong> Marca la incidencia como completada</li>
                        </ul>
                    </div>
                </div>
            </div>
            <div class="text-sm text-gray-600 bg-amber-50 rounded-lg p-4 border border-amber-200">
                <div class="flex items-start gap-3">
                    <i class="fas fa-lightbulb text-amber-600 mt-1 text-lg"></i>
                    <div>
                        <p class="font-semibold text-amber-900 mb-1">Estados de incidencias</p>
                        <ul class="text-amber-700 space-y-1 text-xs">
                            <li>• <strong>Abierta:</strong> Recién creada, sin asignar</li>
                            <li>• <strong>En Progreso:</strong> Siendo atendida por un empleado</li>
                            <li>• <strong>Resuelta:</strong> Problema solucionado (sin botón de resolver)</li>
                            <li>• <strong>Cerrada:</strong> Incidencia finalizada (sin botón de resolver)</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal de detalle de incidencia -->
    <div id="modalDetalle" class="modal">
        <div class="modal-content">
            <div class="flex justify-between items-center mb-6 pb-4 border-b border-gray-200">
                <h2 class="text-2xl font-bold text-gray-800">
                    <i class="fas fa-exclamation-triangle text-cyan-600 mr-2"></i>
                    Detalle de Incidencia
                </h2>
                <button class="close text-gray-400 hover:text-gray-600 text-2xl font-bold transition-colors">&times;</button>
            </div>
            <div class="space-y-4">
                <div class="grid grid-cols-2 gap-4">
                    <div class="bg-gradient-to-br from-cyan-50 to-blue-50 p-4 rounded-lg border border-cyan-200">
                        <p class="text-xs text-cyan-700 mb-1 font-semibold uppercase tracking-wide">ID Incidencia</p>
                        <p id="detalleId" class="font-bold text-xl text-gray-900">#INC-001</p>
                    </div>
                    <div class="bg-gradient-to-br from-purple-50 to-pink-50 p-4 rounded-lg border border-purple-200">
                        <p class="text-xs text-purple-700 mb-1 font-semibold uppercase tracking-wide">Paciente</p>
                        <p id="detallePaciente" class="font-bold text-gray-900">María González Pérez</p>
                    </div>
                    <div class="bg-gray-50 p-4 rounded-lg border border-gray-200">
                        <p class="text-xs text-gray-600 mb-1 font-semibold uppercase tracking-wide">Fecha Registro</p>
                        <p id="detalleFecha" class="font-bold text-gray-900">21/10/2025</p>
                    </div>
                    <div class="bg-gray-50 p-4 rounded-lg border border-gray-200">
                        <p class="text-xs text-gray-600 mb-1 font-semibold uppercase tracking-wide">Categoría</p>
                        <p id="detalleCategoria" class="font-bold text-gray-900">Hardware</p>
                    </div>
                    <div class="bg-gray-50 p-4 rounded-lg border border-gray-200">
                        <p class="text-xs text-gray-600 mb-1 font-semibold uppercase tracking-wide">Prioridad</p>
                        <p id="detallePrioridad" class="font-bold text-gray-900">Media</p>
                    </div>
                    <div class="bg-gray-50 p-4 rounded-lg border border-gray-200">
                        <p class="text-xs text-gray-600 mb-1 font-semibold uppercase tracking-wide">Estado</p>
                        <p id="detalleEstado" class="font-bold text-gray-900">Abierta</p>
                    </div>
                    <div class="col-span-2 bg-gray-50 p-4 rounded-lg border border-gray-200">
                        <p class="text-xs text-gray-600 mb-1 font-semibold uppercase tracking-wide">Descripción</p>
                        <p id="detalleDescripcion" class="font-bold text-gray-900">Error en sistema de citas médicas</p>
                    </div>
                    <div class="bg-gray-50 p-4 rounded-lg border border-gray-200">
                        <p class="text-xs text-gray-600 mb-1 font-semibold uppercase tracking-wide">Responsable</p>
                        <p id="detalleResponsable" class="font-bold text-gray-900">Carlos Ramírez</p>
                    </div>
                    <div class="bg-gray-50 p-4 rounded-lg border border-gray-200">
                        <p class="text-xs text-gray-600 mb-1 font-semibold uppercase tracking-wide">Fecha Resolución</p>
                        <p id="detalleFechaResolucion" class="font-bold text-gray-900">Pendiente</p>
                    </div>
                    <div class="col-span-2 bg-gray-50 p-4 rounded-lg border border-gray-200">
                        <p class="text-xs text-gray-600 mb-1 font-semibold uppercase tracking-wide">Observaciones</p>
                        <p id="detalleObservaciones" class="font-bold text-gray-900">El sistema muestra error 404 al intentar agendar citas en línea.</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal de edición -->
    <div id="modalEditar" class="modal">
        <div class="modal-content">
            <div class="flex justify-between items-center mb-6 pb-4 border-b border-gray-200">
                <h2 class="text-2xl font-bold text-gray-800">
                    <i class="fas fa-edit text-blue-600 mr-2"></i>
                    Editar Incidencia
                </h2>
                <button class="close text-gray-400 hover:text-gray-600 text-2xl font-bold transition-colors">&times;</button>
            </div>
            <form id="formEditar" class="space-y-4">
                <input type="hidden" id="editId">
                <div class="grid grid-cols-2 gap-4">
                    <div class="col-span-2">
                        <label class="block text-sm font-semibold text-gray-700 mb-2">
                            <i class="fas fa-align-left text-cyan-600 mr-1"></i>
                            Descripción
                        </label>
                        <textarea id="editDescripcion" rows="3" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-cyan-200 focus:border-cyan-500">Error en sistema de citas médicas</textarea>
                    </div>
                    <div>
                        <label class="block text-sm font-semibold text-gray-700 mb-2">
                            <i class="fas fa-info-circle text-cyan-600 mr-1"></i>
                            Estado
                        </label>
                        <select id="editEstado" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-cyan-200 focus:border-cyan-500 bg-white">
                            <option>Abierta</option>
                            <option>En Progreso</option>
                            <option>Resuelta</option>
                            <option>Cerrada</option>
                        </select>
                    </div>
                    <div>
                        <label class="block text-sm font-semibold text-gray-700 mb-2">
                            <i class="fas fa-tags text-cyan-600 mr-1"></i>
                            Categoría
                        </label>
                        <select id="editCategoria" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-cyan-200 focus:border-cyan-500 bg-white">
                            <option>Hardware</option>
                            <option>Software</option>
                            <option>Equipamiento Médico</option>
                            <option>Infraestructura</option>
                            <option>Insumos</option>
                            <option>Otro</option>
                        </select>
                    </div>
                    <div>
                        <label class="block text-sm font-semibold text-gray-700 mb-2">
                            <i class="fas fa-exclamation-circle text-cyan-600 mr-1"></i>
                            Prioridad
                        </label>
                        <select id="editPrioridad" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-cyan-200 focus:border-cyan-500 bg-white">
                            <option>Baja</option>
                            <option>Media</option>
                            <option>Alta</option>
                        </select>
                    </div>
                    <div>
                        <label class="block text-sm font-semibold text-gray-700 mb-2">
                            <i class="fas fa-user-tie text-cyan-600 mr-1"></i>
                            Responsable
                        </label>
                        <input type="text" id="editResponsable" value="Carlos Ramírez" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-cyan-200 focus:border-cyan-500" readonly>
                    </div>
                    <div class="col-span-2">
                        <label class="block text-sm font-semibold text-gray-700 mb-2">
                            <i class="fas fa-comment text-cyan-600 mr-1"></i>
                            Observaciones
                        </label>
                        <textarea id="editObservaciones" rows="3" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-cyan-200 focus:border-cyan-500">El sistema muestra error 404 al intentar agendar citas en línea.</textarea>
                    </div>
                </div>
                <div class="flex gap-4 pt-4">
                    <button type="button" class="flex-1 bg-gray-200 hover:bg-gray-300 text-gray-800 font-semibold py-3 px-4 rounded-lg transition-colors">
                        <i class="fas fa-times mr-2"></i>
                        Cancelar
                    </button>
                    <button type="submit" class="flex-1 bg-gradient-to-r from-blue-500 to-blue-600 hover:from-blue-600 hover:to-blue-700 text-white font-semibold py-3 px-4 rounded-lg transition-all shadow-md hover:shadow-lg">
                        <i class="fas fa-save mr-2"></i>
                        Guardar Cambios
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Modal de resolver incidencia -->
    <div id="modalResolver" class="modal">
        <div class="modal-content max-w-lg">
            <div class="flex justify-between items-start mb-6">
                <div class="flex items-center gap-3">
                    <div class="w-12 h-12 bg-gradient-to-br from-green-100 to-emerald-100 rounded-full flex items-center justify-center">
                        <i class="fas fa-check-circle text-green-600 text-2xl"></i>
                    </div>
                    <div>
                        <h2 class="text-2xl font-bold text-gray-800">Resolver Incidencia</h2>
                        <p class="text-sm text-gray-500 mt-1">Marcar como completada y resuelta</p>
                    </div>
                </div>
                <button class="close text-gray-400 hover:text-gray-600 text-2xl font-bold transition-colors">&times;</button>
            </div>

            <div class="bg-gradient-to-r from-green-50 to-emerald-50 border-l-4 border-green-500 p-4 rounded-lg mb-6">
                <div class="flex items-start">
                    <i class="fas fa-info-circle text-green-600 mt-1 mr-3"></i>
                    <div>
                        <p class="text-sm font-semibold text-green-800 mb-1">¿Estás seguro de resolver esta incidencia?</p>
                        <p class="text-sm text-green-700">Esta acción actualizará el estado de la incidencia a "Resuelta" y registrará la fecha de resolución.</p>
                    </div>
                </div>
            </div>

            <form id="formResolver" class="space-y-5">
                <input type="hidden" id="resolverId">

                <div>
                    <label class="block text-sm font-semibold text-gray-700 mb-2">
                        <i class="fas fa-comment-dots text-cyan-600 mr-1"></i>
                        Comentario de resolución
                        <span class="text-gray-400 font-normal text-xs">(opcional)</span>
                    </label>
                    <textarea
                        id="comentarioResolucion"
                        name="comentarioResolucion"
                        rows="4"
                        placeholder="Describe cómo se resolvió la incidencia, qué acciones se tomaron, etc..."
                        class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-200 focus:border-green-500 transition-colors resize-none"
                    ></textarea>
                    <p class="text-xs text-gray-500 mt-2">
                        <i class="fas fa-lightbulb text-yellow-500 mr-1"></i>
                        Este comentario se agregará a las observaciones de la incidencia
                    </p>
                </div>

                <div class="flex gap-3 pt-4 border-t border-gray-200">
                    <button
                        type="button"
                        id="btnCancelarResolver"
                        class="flex-1 flex items-center justify-center gap-2 bg-gray-100 hover:bg-gray-200 text-gray-700 font-semibold py-3 px-4 rounded-lg transition-all"
                    >
                        <i class="fas fa-times"></i>
                        <span>Cancelar</span>
                    </button>
                    <button
                        type="submit"
                        id="btnConfirmarResolver"
                        class="flex-1 flex items-center justify-center gap-2 bg-gradient-to-r from-green-500 to-emerald-600 hover:from-green-600 hover:to-emerald-700 text-white font-semibold py-3 px-4 rounded-lg transition-all shadow-md hover:shadow-lg"
                    >
                        <i class="fas fa-check-circle"></i>
                        <span>Resolver Incidencia</span>
                    </button>
                </div>
            </form>
        </div>
    </div>

    <script src="/static/js/consultarIncidencia.js"></script>

    {% include 'footer.html' %}
</body>
</html>
